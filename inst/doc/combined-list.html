<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Alexander Coppock" />

<meta name="date" content="2020-03-17" />

<title>Combining List Experiments with Direct Questions using combinedListDirect()</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Combining List Experiments with Direct Questions using <code>combinedListDirect()</code></h1>
<h4 class="author">Alexander Coppock</h4>
<h4 class="date">2020-03-17</h4>



<p>This vignette will provide a brief introduction to the combined list estimator described in Aronow, Coppock, Crawford, and Green (2015): Combining List Experiment and Direct Question Estimates of Sensitive Behavior Prevalence. In addition to the mechanics of the <code>combinedListDirect()</code> function, you will learn how to interpret the results of the two placebo tests that can serve as checks on the validity of the list experimental assumptions.</p>
<p>If you want to use the combined estimator, you must tweak your standard list experimental design. All subjects must be asked the direct question in addition to being randomly assigned to either treatment or control lists. It is recommended that the order in which subjects are asked the two questions (direct and list) be randomized.</p>
<div id="setup" class="section level1">
<h1>Setup</h1>
<p>List experiments are designed to estimate the prevalence of some sensitive attitude or behavior. Typically, direct questioning would lead to an underestimate of prevalence because some subjects who do hold the attitude or engage in the behavior would withhold.</p>
<p>For example, suppose we have 1500 subjects, 1000 of whom engage, but 500 of whom would withhold if asked directly.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Set a seed for reproducibility</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">123</span>) </a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># Define subject types.</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co"># Truthfully respond &quot;Yes&quot; to direct question</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">N.trueadmitter &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co"># Falsely respond &quot;No&quot; to direct question</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">N.withholder &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co"># Truthfully respond &quot;No&quot; to direct question</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13">N.innocent &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1-15" data-line-number="15">type &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;TA&quot;</span>, <span class="st">&quot;WH&quot;</span>, <span class="st">&quot;IN&quot;</span>), <span class="dt">times=</span><span class="kw">c</span>(N.trueadmitter, N.withholder, N.innocent))</a></code></pre></div>
</div>
<div id="direct-question" class="section level1">
<h1>Direct Question</h1>
<p>Now suppose we were to ask the direct question, “Do you engage?”</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">D &lt;-<span class="st"> </span><span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;TA&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">direct.est &lt;-<span class="st"> </span><span class="kw">mean</span>(D)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">direct.est</a></code></pre></div>
<pre><code>## [1] 0.3333333</code></pre>
<p>The true proportion of engagers is 1000/1500 = 0.67. However, the direct question is badly biased by social desirability: our direct question prevalence estimate is 0.33.</p>
</div>
<div id="conventional-list-experiment" class="section level1">
<h1>Conventional List Experiment</h1>
<p>A conventional list experiment addresses social desirability by asking a control group how many of <code>J</code> (non-sensitive) behaviors they engage in and a treatment group how many of <code>J + 1</code> behaviors they engage in, where the additional behavior is the sensitive one. The (possibly covariate-adjusted) difference-in-means renders a prevalence estimate that is free from social desiriability bias. This estimate relies on two additional assumptions: No Liars and No Design Effects. No Liars requires that treatment subjects respond truthfully to the list question and No Design Effects requires that the presence of the sensitive item does not change treated subjects’ responses to the non-sensitive items.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">N &lt;-<span class="st"> </span><span class="kw">length</span>(type)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co"># Generate list response potential outcomes</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co"># Control potential outcome</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">Y0 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, N, <span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co"># Treated potential outcome is 1 higher for true admitters and withholders</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">Y1 &lt;-<span class="st"> </span>Y0 <span class="op">+</span><span class="st"> </span><span class="kw">ifelse</span>(type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;TA&quot;</span>, <span class="st">&quot;WH&quot;</span>), <span class="dv">1</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb4-9" data-line-number="9"></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co"># Conduct random assignment</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">Z &lt;-<span class="st"> </span><span class="kw">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb4-12" data-line-number="12"></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co"># Reveal list responses</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14">Y &lt;-<span class="st"> </span>Z<span class="op">*</span>Y1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>Z)<span class="op">*</span>Y0</a>
<a class="sourceLine" id="cb4-15" data-line-number="15"></a>
<a class="sourceLine" id="cb4-16" data-line-number="16">list.est &lt;-<span class="st"> </span><span class="kw">mean</span>(Y[Z<span class="op">==</span><span class="dv">1</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(Y[Z<span class="op">==</span><span class="dv">0</span>])</a>
<a class="sourceLine" id="cb4-17" data-line-number="17">list.se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((<span class="kw">var</span>(Y[Z<span class="op">==</span><span class="dv">1</span>])<span class="op">/</span><span class="kw">sum</span>(Z) <span class="op">+</span><span class="st"> </span><span class="kw">var</span>(Y[Z<span class="op">==</span><span class="dv">0</span>])<span class="op">/</span><span class="kw">sum</span>(<span class="dv">1</span><span class="op">-</span>Z)))</a>
<a class="sourceLine" id="cb4-18" data-line-number="18">list.est</a></code></pre></div>
<pre><code>## [1] 0.619082</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">list.se</a></code></pre></div>
<pre><code>## [1] 0.05910645</code></pre>
<p>The list experiment comes closer to the truth: our estimate is now 0.62. The standard error is somewhat large, at 0.06. A principal difficulty with using list experiments is that estimates can be quite imprecise.</p>
</div>
<div id="combined-list-experiment" class="section level1">
<h1>Combined List Experiment</h1>
<p>The purpose of the combined estimator is to increase precision by combining direct questioning with list experimentation. The combined estimate is a weighted average of the direct question estimate and the list experiment estimate among those who answer “No” to the direct question. Under two additional assumptions (Treatment Independence and Monotonicity), the combined estimator yields more precise estimates than the conventional estimator. Treatment independence requires that the treatment not have any effect on the direct question response. Monotonicity requires that no subjects “falsely confess” to the direct question.</p>
<p>Estimation is straightforward:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">library</span>(list)</a></code></pre></div>
<pre><code>## Loading required package: sandwich</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Wrap up all data in a dataframe</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Y, Z, D)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">out<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">combinedListDirect</span>(<span class="dt">formula =</span> Y <span class="op">~</span><span class="st"> </span>Z, <span class="dt">data =</span> df, <span class="dt">treat =</span> <span class="st">&quot;Z&quot;</span>, <span class="dt">direct =</span> <span class="st">&quot;D&quot;</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">out<span class="fl">.1</span></a></code></pre></div>
<pre><code>## 
##  Combined List Estimates 
## 
## Call: combinedListDirect(formula = Y ~ Z, data = df, treat = &quot;Z&quot;, direct = &quot;D&quot;)
## 
##  Prevalence estimate
##                Prevalence
## Estimate       0.69551882
## Standard Error 0.04933932</code></pre>
<p>If we compare the standard errors of the two methods, we can see that the combined estimator is more precise than the conventional estimator.</p>
</div>
<div id="placebo-tests" class="section level1">
<h1>Placebo Tests</h1>
<p>The <code>combinedListDirect()</code> function automatically conducts two placebo tests that can check the assumptions underlying the list experimental design.</p>
<div id="placebo-test-i" class="section level2">
<h2>Placebo Test I</h2>
<p>This test checks to see if the list experiment estimate among those who answer “Yes” to the direct question is significantly different from 1. Rejecting the hypothesis that this estimate is equal to one, indicates that one or more of four list experiment assumptions might be wrong: No Liars, No Design Effects, Treatment Ignorability, or Monotonicity.</p>
</div>
<div id="placebo-test-ii" class="section level2">
<h2>Placebo Test II</h2>
<p>This test checks to see if the direct question is affected by the treatment. If Treatment Independnce is satisfied, the (possibly covariate-adjusted) difference-in-means should not be significantly different from 0.</p>
<p>It’s easy to see the results of both tests using <code>summary.comblist()</code>. Because we generated the data above respecting the list experiment assumptions, we know that we should pass both tests.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">summary</span>(out<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## 
##  Combined List Estimates 
## 
## Call: combinedListDirect(formula = Y ~ Z, data = df, treat = &quot;Z&quot;, direct = &quot;D&quot;)
## 
##  Prevalence estimates
##                  Combined     Direct Conventional
## Estimate       0.69551882 0.33333333   0.61908199
## Standard Error 0.04933932 0.01217567   0.05910645
## 
##  Placebo Test I
##        Beta is the conventional list experiment estimate among those who answer 'Yes' to the direct question.
##        Ho: beta = 1
##        Ha: beta != 1
##       
##        Estimate         SE          p   n
## beta 0.7702253 0.09870956 0.01992348 500
## 
##  Placebo Test II
##        Delta is the average effect of the receiving the treatment list on the direct question response.
##        Ho: delta = 0
##        Ha: delta != 0
##       
##          Estimate         SE         p    n
## delta 0.00177798 0.02436116 0.9418187 1500</code></pre>
<p>The high p-values for both tests suggest that we cannot reject either null hypothesis. The assumptions underlying both the conventional and combined list experiment estimators have not been demonstrated to be false.</p>
</div>
<div id="violations-of-assumptions" class="section level2">
<h2>Violations of assumptions</h2>
<p>Let’s show cases where the tests indicate that there are problems. First, let’s consider the case where some subjects are “design affected”, i.e., they lower their response to the non-sensitive items when the sensitive item is also on the list.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># Define three subject types as before plus one new type</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">N.trueadmitter &lt;-<span class="st"> </span><span class="dv">400</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">N.withholder &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5">N.innocent &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co"># Truthfully responds &quot;Yes&quot; to direct question</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co"># but decreases response to the non-sensitive items </span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co"># in the presence of the sensitive item</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10">N.designaffected &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"></a>
<a class="sourceLine" id="cb14-12" data-line-number="12">type &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;TA&quot;</span>, <span class="st">&quot;WH&quot;</span>, <span class="st">&quot;IN&quot;</span>, <span class="st">&quot;DA&quot;</span>), </a>
<a class="sourceLine" id="cb14-13" data-line-number="13">            <span class="dt">times=</span><span class="kw">c</span>(N.trueadmitter, N.withholder, N.innocent, N.designaffected))</a>
<a class="sourceLine" id="cb14-14" data-line-number="14">N &lt;-<span class="st"> </span><span class="kw">length</span>(type)</a>
<a class="sourceLine" id="cb14-15" data-line-number="15"></a>
<a class="sourceLine" id="cb14-16" data-line-number="16">D &lt;-<span class="st"> </span><span class="kw">ifelse</span>(type<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;TA&quot;</span>,<span class="st">&quot;DA&quot;</span>), <span class="dv">1</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb14-17" data-line-number="17"></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co"># Control potential outcome</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19">Y0 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, N, <span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-20" data-line-number="20"></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co"># Treated potential outcome is 1 higher for true admitters and withholders</span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22"><span class="co"># Note that it is NOT higher for those who are &quot;design affected&quot;</span></a>
<a class="sourceLine" id="cb14-23" data-line-number="23">Y1 &lt;-<span class="st"> </span>Y0 <span class="op">+</span><span class="st"> </span><span class="kw">ifelse</span>(type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;TA&quot;</span>, <span class="st">&quot;WH&quot;</span>), <span class="dv">1</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb14-24" data-line-number="24"></a>
<a class="sourceLine" id="cb14-25" data-line-number="25">Z &lt;-<span class="st"> </span><span class="kw">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb14-26" data-line-number="26">Y &lt;-<span class="st"> </span>Z<span class="op">*</span>Y1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>Z)<span class="op">*</span>Y0</a>
<a class="sourceLine" id="cb14-27" data-line-number="27">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Y, Z, D)</a>
<a class="sourceLine" id="cb14-28" data-line-number="28"></a>
<a class="sourceLine" id="cb14-29" data-line-number="29">out<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">combinedListDirect</span>(<span class="dt">formula =</span> Y <span class="op">~</span><span class="st"> </span>Z, <span class="dt">data =</span> df, <span class="dt">treat =</span> <span class="st">&quot;Z&quot;</span>, <span class="dt">direct =</span> <span class="st">&quot;D&quot;</span>)</a>
<a class="sourceLine" id="cb14-30" data-line-number="30"></a>
<a class="sourceLine" id="cb14-31" data-line-number="31"><span class="co"># Extract Placebo Test I results </span></a>
<a class="sourceLine" id="cb14-32" data-line-number="32"><span class="kw">unlist</span>(out<span class="fl">.2</span><span class="op">$</span>placebo.I)</a></code></pre></div>
<pre><code>##     estimate           se            p            n 
##   0.75978816   0.10374990   0.02059668 500.00000000</code></pre>
<p>The low p-value suggests that we should reject the hypothesis that the list experimental estimate is equal to one among those who answer “Yes” to the direct question. We could reject this hypothesis if any of the four assumptions above were violated in some way. If the null is rejected, the list experiment estimates - both conventional and combined - are possibly biased.</p>
<hr />
<p>Next let’s consider a case where the treatment does affect the direct question response, violating the Treatment Ignorability assumption.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># Define three subject types as before plus one new type</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"></a>
<a class="sourceLine" id="cb16-3" data-line-number="3">N.trueadmitter &lt;-<span class="st"> </span><span class="dv">400</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4">N.withholder &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">N.innocent &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co"># Truthfully answers &quot;Yes&quot; when in control</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co"># But falsely answers &quot;No&quot; when in treatment</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9">N.affectedbytreatment &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"></a>
<a class="sourceLine" id="cb16-11" data-line-number="11">type &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;TA&quot;</span>, <span class="st">&quot;WH&quot;</span>, <span class="st">&quot;IN&quot;</span>, <span class="st">&quot;ABT&quot;</span>), </a>
<a class="sourceLine" id="cb16-12" data-line-number="12">            <span class="dt">times=</span><span class="kw">c</span>(N.trueadmitter, N.withholder, N.innocent, N.affectedbytreatment))</a>
<a class="sourceLine" id="cb16-13" data-line-number="13">N &lt;-<span class="st"> </span><span class="kw">length</span>(type)</a>
<a class="sourceLine" id="cb16-14" data-line-number="14"></a>
<a class="sourceLine" id="cb16-15" data-line-number="15"><span class="co"># Direct Question Potential outcomes</span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16">D0 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(type<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;TA&quot;</span>,<span class="st">&quot;ABT&quot;</span>), <span class="dv">1</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb16-17" data-line-number="17">D1 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(type<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;TA&quot;</span>), <span class="dv">1</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb16-18" data-line-number="18"></a>
<a class="sourceLine" id="cb16-19" data-line-number="19"><span class="co"># List Experiment potential outcomes</span></a>
<a class="sourceLine" id="cb16-20" data-line-number="20">Y0 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, N, <span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb16-21" data-line-number="21">Y1 &lt;-<span class="st"> </span>Y0 <span class="op">+</span><span class="st"> </span><span class="kw">ifelse</span>(type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;TA&quot;</span>, <span class="st">&quot;WH&quot;</span>), <span class="dv">1</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb16-22" data-line-number="22"></a>
<a class="sourceLine" id="cb16-23" data-line-number="23"><span class="co"># Reveal outcomes according to random assignment</span></a>
<a class="sourceLine" id="cb16-24" data-line-number="24">Z &lt;-<span class="st"> </span><span class="kw">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb16-25" data-line-number="25">Y &lt;-<span class="st"> </span>Z<span class="op">*</span>Y1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>Z)<span class="op">*</span>Y0</a>
<a class="sourceLine" id="cb16-26" data-line-number="26">D &lt;-<span class="st"> </span>Z<span class="op">*</span>D1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>Z)<span class="op">*</span>D0</a>
<a class="sourceLine" id="cb16-27" data-line-number="27"></a>
<a class="sourceLine" id="cb16-28" data-line-number="28">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Y, Z, D)</a>
<a class="sourceLine" id="cb16-29" data-line-number="29"></a>
<a class="sourceLine" id="cb16-30" data-line-number="30">out<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">combinedListDirect</span>(<span class="dt">formula =</span> Y <span class="op">~</span><span class="st"> </span>Z, <span class="dt">data =</span> df, <span class="dt">treat =</span> <span class="st">&quot;Z&quot;</span>, <span class="dt">direct =</span> <span class="st">&quot;D&quot;</span>)</a>
<a class="sourceLine" id="cb16-31" data-line-number="31"></a>
<a class="sourceLine" id="cb16-32" data-line-number="32"><span class="co"># Extract Placebo Test II results </span></a>
<a class="sourceLine" id="cb16-33" data-line-number="33"><span class="kw">unlist</span>(out<span class="fl">.3</span><span class="op">$</span>placebo.II)</a></code></pre></div>
<pre><code>##      estimate            se             p             n 
##   -0.05092491    0.02364766    0.03128051 1500.00000000</code></pre>
<p>Again, the low p-value suggests that the null hypothesis that the average effect of the treatment on the direct response is zero is false. When this null is rejected, the combined estimator may yield biased results.</p>
</div>
</div>
<div id="covariate-adjustment" class="section level1">
<h1>Covariate Adjustment</h1>
<p>Another way to increase the precision of list experiments is to include pre-treatment covariates that are predictive of the list experiment outcome. The combined estimator can accomodate the inclusion of pre-treatment covariates quite easily.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># Define subject types.</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">N.trueadmitter &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3">N.withholder &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4">N.innocent &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"></a>
<a class="sourceLine" id="cb18-6" data-line-number="6">type &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;TA&quot;</span>, <span class="st">&quot;WH&quot;</span>, <span class="st">&quot;IN&quot;</span>), <span class="dt">times=</span><span class="kw">c</span>(N.trueadmitter, N.withholder, N.innocent))</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">N &lt;-<span class="st"> </span><span class="kw">length</span>(type)</a>
<a class="sourceLine" id="cb18-8" data-line-number="8"></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co"># Generate a predictive pre-treatment covariate &quot;X&quot;)</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10">X &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-11" data-line-number="11"></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="co"># Control potential outcome is related to &quot;X&quot;</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13">Y0 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">cut</span>(X <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(N), <span class="dt">breaks =</span> <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb18-14" data-line-number="14">Y1 &lt;-<span class="st"> </span>Y0 <span class="op">+</span><span class="st"> </span><span class="kw">ifelse</span>(type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;TA&quot;</span>, <span class="st">&quot;WH&quot;</span>), <span class="dv">1</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb18-15" data-line-number="15"></a>
<a class="sourceLine" id="cb18-16" data-line-number="16">Z &lt;-<span class="st"> </span><span class="kw">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb18-17" data-line-number="17">D &lt;-<span class="st"> </span><span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;TA&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb18-18" data-line-number="18">Y &lt;-<span class="st"> </span>Z<span class="op">*</span>Y1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>Z)<span class="op">*</span>Y0</a>
<a class="sourceLine" id="cb18-19" data-line-number="19"></a>
<a class="sourceLine" id="cb18-20" data-line-number="20">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Y, Z, D, X)</a>
<a class="sourceLine" id="cb18-21" data-line-number="21"></a>
<a class="sourceLine" id="cb18-22" data-line-number="22"><span class="co"># Conduct estimation without covariate adjustment</span></a>
<a class="sourceLine" id="cb18-23" data-line-number="23">out<span class="fl">.4</span> &lt;-<span class="st"> </span><span class="kw">combinedListDirect</span>(<span class="dt">formula =</span> Y <span class="op">~</span><span class="st"> </span>Z, <span class="dt">data =</span> df, <span class="dt">treat =</span> <span class="st">&quot;Z&quot;</span>, <span class="dt">direct =</span> <span class="st">&quot;D&quot;</span>)</a>
<a class="sourceLine" id="cb18-24" data-line-number="24">out<span class="fl">.4</span></a></code></pre></div>
<pre><code>## 
##  Combined List Estimates 
## 
## Call: combinedListDirect(formula = Y ~ Z, data = df, treat = &quot;Z&quot;, direct = &quot;D&quot;)
## 
##  Prevalence estimate
##                Prevalence
## Estimate       0.68373531
## Standard Error 0.03165778</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co"># Conduct estimation with covariate adjustment</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co"># Just add the covariate on the right-hand side of the formula</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3">out<span class="fl">.5</span> &lt;-<span class="st"> </span><span class="kw">combinedListDirect</span>(<span class="dt">formula =</span> Y <span class="op">~</span><span class="st"> </span>Z <span class="op">+</span><span class="st"> </span>X, <span class="dt">data =</span> df, <span class="dt">treat =</span> <span class="st">&quot;Z&quot;</span>, <span class="dt">direct =</span> <span class="st">&quot;D&quot;</span>)</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">out<span class="fl">.5</span></a></code></pre></div>
<pre><code>## 
##  Combined List Estimates 
## 
## Call: combinedListDirect(formula = Y ~ Z + X, data = df, treat = &quot;Z&quot;, 
##     direct = &quot;D&quot;)
## 
##  Prevalence estimate
##                Prevalence
## Estimate       0.67850607
## Standard Error 0.02051244</code></pre>
<p>A comparison of the standard errors with and without covariate adjustment confirms that the covariate-adjusted estimator is more precise. When you include covariates, the placebo tests become more powerful as well.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
